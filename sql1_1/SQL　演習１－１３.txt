１－13

問１回答日時が新しい順に並べ、評価も行う。

//SELECT命令を出力する。テーブルからデータを取り出す
SELECT　
　//nameの列を取り出す。
  name AS 小藤直輝,
　//COUNT(*)の列を取り出す。
  COUNT(*) AS カウント数,
　//場合分けをする。
  CASE
　　//answer1の列について行う。	
    answer1
　　//条件を付ける。
    WHEN 3 THEN 'ためになった'
　　//条件を付ける。	
    WHEN 2 THEN '普通'	
　//条件を付ける。
    WHEN 1 THEN '役に立たない'
　//場合分けの終了
  END AS 評価
　//answer2の列を取り出す。
  answer2 AS 感想 
//何のテーブルからデータを取り出すか
FROM
  //参照するテーブル名の入力
  quest
//情報を並べる順序を決める。
ORDER BY
　//条件の入力。
  answer1 DESC
;



問２本の貸し出し数を表示し、評価も行う。
//SELECT命令を出力する。テーブルからデータを取り出す
SELECT　
　//isbnの列を取り出す。
  isbn,
　//count(*)の列を取り出す。
  count(*) AS 貸出数,
　//場合分けをする。
  CASE
　　//条件を付ける。
    WHEN count(*) >= 10 THEN '好評'	
  　//条件を付ける。
    WHEN count(*) >= 5 THEN '普通'
　　//条件を付ける。	
    ELSE '不評'
　//場合分けの終了
  END AS 評価 
//何のテーブルからデータを取り出すか 
FROM
  //参照するテーブル名の入力
  rental
//情報を並べる順序を決める。
ORDER BY
　//条件の入力。
  isbn
;



問3リンク元ごとのアクセス数を求め、評価も行う。

//SELECT命令を出力する。テーブルからデータを取り出す
SELECT　
　//numberの列を取り出す。
  number,
　//count(*)の列を取り出す。
  count(*) AS 貸出数,
　//場合分けをする。
  CASE
　　//条件を付ける。
    WHEN count(*) >= 50 THEN 'A'	
　　//条件を付ける。 
    WHEN count(*) >= 10 THEN 'B'	
　　//条件を付ける。 
    ELSE 'C'
　//場合分けの終了
  END AS 評価  
//何のテーブルからデータを取り出すか
FROM
  //参照するテーブル名の入力
  access_log
//情報を並べる順序を決める。
GROUP BY
　//条件の入力。
  number
//付随する条件の入力
HAVING
　//条件の入力。
  COUNT(*) > 3
//情報を並べる順序を決める。
ORDER BY
　//条件の入力。
  COUNT(*) DESC

;








問４著者ごとの書籍数を求め、評価も行う。

//SELECT命令を出力する。テーブルからデータを取り出す
SELECT　
　//numberの列を取り出す。
  number,
　//count(*)の列を取り出す。
  count(*) AS 貸出数,
　//場合分けをする。
  CASE
　　//条件を付ける。
    WHEN count(*) >= 4 THEN '多い'	
　　//条件を付ける。
    WHEN count(*) >= 2 THEN '普通'	
　　//条件を付ける。
    ELSE '少ない'
　//場合分けの終了
  END AS 評価  
//何のテーブルからデータを取り出すか
FROM
  //参照するテーブル名の入力
  author_books
//情報を並べる順序を決める。
GROUP BY
　//条件の入力。
  number
;






























